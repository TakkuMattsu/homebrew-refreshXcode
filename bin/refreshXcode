#!/bin/bash

# =====================================
# variable

DERIVED_DATA_DIR=~/Library/Developer/Xcode/DerivedData
DEVICE_SUPPORT_DIR=~/Library/Developer/Xcode/iOS\ DeviceSupport
DIRS="$DERIVED_DATA_DIR,$DEVICE_SUPPORT_DIR"

# =====================================
# function

# Input fucntion
function readInput()
{
  echo ""
  echo -n "Delete Cache of Xcode. Are you sure ? (y/n) > "
  read INPUT
  echo ""
  # ,を区切り文字に
  PRE_IFS=$IFS
  IFS=$','
  if [ "$INPUT" == "y" ]; then
    for dir in ${DIRS}
    do
      isExistCacheDirectory ${dir}
      if [ $? -eq -1 ]; then
        echo ""
        continue
      fi
      echo "Delete ${dir} ..."
      rm -rf "${dir}"
    done
  elif [ "$INPUT" == "n" ]; then
    echo "Bye.."
    exit
  else
    echo "Please \"y\" or \"n\""
    readInput
  fi
}

# Check directory function
function isExistCacheDirectory()
{
  if [ -e "$1" ]; then
    return 0
  else
    echo "$1 does not exist :("
    echo ""
    return -1
  fi
}

# =====================================
# main

echo "============================"
echo "Delete Xcocde cache script"
echo "============================"
readInput

echo "Done.."
